 ëª©í‘œ:
í˜„ì¬ ê°ì • íƒ€ì„ë¼ì¸ì´ ë§¤ API í˜¸ì¶œ ì‹œ ëœë¤ ê°’ìœ¼ë¡œ ìƒì„±ë˜ê³  ìˆìŠµë‹ˆë‹¤.
ì´ë¥¼ ì‹¤ì œ AI ê°ì • ë¶„ì„ ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ ë³€ê²½í•˜ê³ , DBì— ì €ì¥/ì¬ì‚¬ìš©ë˜ë„ë¡ ìˆ˜ì •í•´ì£¼ì„¸ìš”.

---

ğŸ¯ ìš”êµ¬ì‚¬í•­:

1ï¸âƒ£ ê¸°ì¡´ ë¬¸ì œ
- ê°ì • ì ìˆ˜(value)ê°€ 3~8 ì‚¬ì´ ëœë¤ ìƒì„±ë¨
- ê°ì •(emotion)ë„ ë°°ì—´ ['ë³´í†µ', 'í–‰ë³µ', 'ì°¨ë¶„í•¨', 'ê¸°ì¨', 'í˜¸ê¸°ì‹¬', 'í¥ë¶„'] ì¤‘ ëœë¤ ì„ íƒ
- DB ì €ì¥ ì—†ì´ í˜¸ì¶œ ì‹œë§ˆë‹¤ ì´ˆê¸°í™”ë¨

---

2ï¸âƒ£ ê°œì„  ë°©í–¥
- ê²Œì‹œë¬¼ ë¶„ì„ ì‹œ AI ê°ì • ë¶„ì„ ê²°ê³¼(sentiment, tone, emotion) ê¸°ë°˜ìœ¼ë¡œ ì ìˆ˜ ê³„ì‚°
- ìµœê·¼ 7ì¼ê°„ì˜ ê°ì • íë¦„ì„ DBì— ì €ì¥í•˜ê³ , ì¬í˜¸ì¶œ ì‹œ ìºì‹±ëœ ë°ì´í„°ë¥¼ ìš°ì„  ì‚¬ìš©
- í•˜ë£¨ ë‹¨ìœ„ë¡œ ì—…ë°ì´íŠ¸ (ìƒˆ ê²Œì‹œë¬¼ ì—…ë¡œë“œ ì‹œ ê°±ì‹ )

---

3ï¸âƒ£ êµ¬í˜„ ë‹¨ê³„

â‘  DB ìŠ¤í‚¤ë§ˆ (emotion_timeline)
| ì»¬ëŸ¼ëª…       | íƒ€ì…     | ì„¤ëª… |
|---------------|----------|------|
| id            | UUID     | ê¸°ë³¸ í‚¤ |
| user_id       | UUID     | ì‚¬ìš©ì ID |
| persona_id    | UUID     | í˜ë¥´ì†Œë‚˜ ID |
| day           | VARCHAR  | 'Mon', 'Tue', ... |
| emotion       | VARCHAR  | ê°ì • ë¼ë²¨ ('í–‰ë³µ', 'ìŠ¬í””' ë“±) |
| score         | INTEGER  | ê°ì • ê°•ë„ (1~10) |
| updated_at    | TIMESTAMP| ê°±ì‹  ì‹œê° |

â‘¡ AI ë¶„ì„ ë¡œì§
- /api/ai/analyze í˜¸ì¶œ ì‹œ, ë°˜í™˜ ë°ì´í„°ì— ê°ì • ì ìˆ˜ í¬í•¨
  ì˜ˆ: { sentiment: {positive: 0.9}, tone: 'joyful', emotion: 'í–‰ë³µ' }
- computeEmotionScore í•¨ìˆ˜ë¡œ score ë³€í™˜ (ì˜ˆ: positive*10)
- DBì— upsert(day, emotion, score)

â‘¢ API ì—”ë“œí¬ì¸íŠ¸
- GET /api/emotion-timeline?personaId=xxx
  â†’ DBì—ì„œ ìµœê·¼ 7ì¼ ë°ì´í„° ë°˜í™˜
- POST /api/emotion-timeline/update
  â†’ ìƒˆ ê°ì • ë¶„ì„ ê²°ê³¼ë¡œ ìµœì‹ ê°’ ê°±ì‹ 

â‘£ UI ë°˜ì˜
- emotionTimelineì„ DB ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ ë¡œë“œ
- ëœë¤ ìƒì„± ë¡œì§ ì œê±°
- â€œLoading Emotion Dataâ€¦â€ â†’ ì‹¤ì œ ë¶„ì„ ì¤‘ì¼ ë•Œ í‘œì‹œ
- ê°ì •ë³„ ìƒ‰ìƒ ë§¤í•‘ ì¶”ê°€ (í–‰ë³µ=ë…¸ë‘, ìŠ¬í””=íŒŒë‘, ë¶„ë…¸=ë¹¨ê°• ë“±)

---

ğŸ’» ì˜ˆì‹œ ì½”ë“œ
```js
async function fetchEmotionTimeline(personaId) {
  const res = await fetch(`/api/emotion-timeline?personaId=${personaId}`);
  const data = await res.json();
  if (!data || data.timeline.length === 0) {
    console.log('No cached data, fetching AI analysis...');
    const analysis = await fetch(`/api/ai/analyze?personaId=${personaId}`).then(r => r.json());
    await fetch(`/api/emotion-timeline/update`, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ personaId, timeline: analysis.timeline }),
    });
    return analysis.timeline;
  }
  return data.timeline;
}
âœ… ì™„ë£Œ ì¡°ê±´:

ê°ì • íƒ€ì„ë¼ì¸ì´ ëœë¤ì´ ì•„ë‹ˆë¼ ì‹¤ì œ ë¶„ì„ê°’ ê¸°ë°˜ìœ¼ë¡œ í‘œì‹œë¨

ë°ì´í„°ê°€ DBì— ì €ì¥ë˜ì–´ ìƒˆë¡œê³ ì¹¨í•´ë„ ìœ ì§€ë¨

ê°ì •ë³„ ìƒ‰ìƒ/ì´ëª¨ì§€ UI ë§¤í•‘ì´ ì ìš©ë¨

ì½˜ì†”ì— "Loaded from DB" ë˜ëŠ” "Updated from AI" ë¡œê·¸ ì¶œë ¥